<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="ie=edge" http-equiv="X-UA-Compatible">
    <title>MyPage</title>

    <script type="text/javascript">
        var myPageNo;

        function test () {
            myPageNo = document.getElementById("myPageNo").value;
            console.log(myPageNo);
        }

        function follow (memberNo) {
            myPageNo = document.getElementById("myPageNo").value;
            var httpRequest;
            /* 통신에 사용 될 XMLHttpRequest 객체 정의 */
            httpRequest = new XMLHttpRequest();
            /* httpRequest의 readyState가 변화했을때 함수 실행 */
            httpRequest.onreadystatechange = () => {
                /* readyState가 Done이고 응답 값이 200일 때 실행 */
                if (httpRequest.readyState === XMLHttpRequest.DONE) {
                      if (httpRequest.status === 200) {
                        var result = httpRequest.response;
                      } else {
                        alert('Request Error!');
                      }
                }
            };
            /* Get 방식으로 name 파라미터와 함께 요청 */
            httpRequest.open('GET', '/myPage/follow?myPageNo=' + myPageNo + '&followingNo=' + memberNo);
            /* Response Type을 Json으로 사전 정의 */
            httpRequest.responseType = "json";
            /* 정의된 서버에 요청을 전송 */
            httpRequest.send();
        }

        function unfollow (memberNo) {
            myPageNo = document.getElementById("myPageNo").value;
            var httpRequest;
            /* 통신에 사용 될 XMLHttpRequest 객체 정의 */
            httpRequest = new XMLHttpRequest();
            /* httpRequest의 readyState가 변화했을때 함수 실행 */
            httpRequest.onreadystatechange = () => {
                /* readyState가 Done이고 응답 값이 200일 때 실행 */
                if (httpRequest.readyState === XMLHttpRequest.DONE) {
                      if (httpRequest.status === 200) {
                        var result = httpRequest.response;
                      } else {
                        alert('Request Error!');
                      }
                }
            };
            /* Get 방식으로 name 파라미터와 함께 요청 */
            httpRequest.open('GET', '/myPage/unfollow?myPageNo=' + myPageNo + '&followingNo=' + memberNo);
            /* Response Type을 Json으로 사전 정의 */
            httpRequest.responseType = "json";
            /* 정의된 서버에 요청을 전송 */
            httpRequest.send();
        }
    </script>

    <style>
        *{
            border: 1px solid;
        }
        body{

        }
        #myPageBox{

          margin: auto;
          max-width: 1000px;
          display: flex;
          justify-content: center;
        }
        #memberInfo{
          margin-right: 2em;
          width: 30%;
        }
        .boardListBox{
          width: 70%;
          display: flex;
          justify-content: space-evenly;
        }
        .memberListBox{
          width: 70%;
        }
        .memberItem{
          display: flex;
          justify-content: space-between;
        }
        .memberPhoto{
          height:40px;
          width:50px;
        }


        /* 왼쪽 사이드바 스타일 */
        .sidebar {
          float: left;
          /*width: 50%;*/
          padding: 20px;
          background-color: #FAFAF5;
        }
        /* 프로필 사진 스타일 */
        .profile-pic {
          max-width: 100%;
          height: auto;
        }

        .my_btn {
          background-color: #426B1F;
          color: white;
          border: none;
          border-radius: 8px;
          padding: 5% 10%;
        }


    </style>
</head>
<body>

<div data-th-replace="header :: header"></div>
<br>
<div id="myPageBox">
    <div data-th-insert="myPage/memberInfo :: memberInfo" id="memberInfo"></div>
    <!--      <div id="memberInfo" data-th-insert="memberInfo :: memberInfo">회원 정보</div>-->
    <div class="boardListBox" data-th-unless="${list}">
        <div>본인 게시글
            <!--            <div data-th-insert="boardList :: boardList">목록</div>-->
        </div>
        <div>방명록
            <!--            <div data-th-insert="boardList :: boardList">목록</div>-->
        </div>
    </div>
    <div class="memberListBox" data-th-if="${list}">
        <input data-th-value="${myPage.no}" id="myPageNo" type="text">
        <h3 data-th-text="'회원 리스트'"></h3>
        <div data-th-each="member : ${list}">
            <div class="memberItem">
                <input data-th-id="memberNo" data-th-value="${member.no}" type="hidden">
                <img class="memberPhoto" data-th-src="'/images/avatar.png'">
                <!--                <img data-th-src="${member.photo}">-->
                <span data-th-text="${member.nick}"></span>
                <button data-th-if="${!loginUser.getFollowMemberSet().contains(member)}"
                        data-th-onclick="|follow(${member.no})|">팔로잉
                </button>
                <button data-th-if="${loginUser.getFollowMemberSet().contains(member)}"
                        data-th-onclick="|unfollow(${member.no})|">팔로잉 취소
                </button>
                <button data-th-onclick="test()">test</button>
            </div>
        </div>
    </div>
</div>

<div data-th-replace="footer :: footer"></div>

</body>
</html>
